主要任务是把分组从源端传到目的端，为分组交换网上的不同主机提供通讯服务。网络层的单位是数据报

功能：
1. 路由选择与分组转发（最佳路径）
2. 异构网络互联
3. 拥塞控制（开环，闭环）

## 路由算法
1. 静态路由算法：管理员手动配置路由信息

2. 动态路由算法：路由器间彼此交换信息，按路由算法优化出路由算法
    * 链路状态路由算法 OSPF 由所有路由器掌握完整的网络拓扑和链路费用
    * 距离向量路由算法 RIP 路由器只掌握物理相邻的邻居及链路费用
    * 路由更新快，适合大型网络。算法复杂，网络负担大
    
分层次的路由选择协议：
1. 因特网规模巨大
2. 许多单位不想让外界知道自己的路由选择协议

由于以上两个原因，采取：

自制系统AS：在单一技术管理下的一组路由器。一个AS内所有网络都属于一个行政单位来管辖。

* 内部网关协议IGP ： 一个AS内使用RIP,OSPF
* 外部网关协议EGP : AS之间使用BGP

![img.png](tcpip.png)

## IP数据报格式

ip数据报的首部分成固定部分和可变部分，后面接着数据部分

![img.png](ipshuju.png)

ip数据报分片相关参数：
* 标识 ： 同一数据报使用同一标识
* 标志 ： 后两位有意义
  * 中间位DF： DF=1禁止分片，=0允许分片
  * 最低位MF： MF=1表示后面还有分片，=0表示后面没有分片  
* 片偏移 ： 某片在原分组中的位置，单位为8b

### 经过路由协议后，ip数据报发生了什么变化？
首部发生的变化
1. 生存时间(TTL)必定减一，则首部检验和也必定发生变化
2. 标志，片偏移，数据报总长度可能发生变化

1. mac地址

如果是NAT路由器：源ip地址和端口号也会发生变化

## ip地址

ip地址的分类

![img.png](ipaddr.png)

A类： 10.0.0.0 - 10.255.255.255

B类：172.16。0.0 - 172.31.255.255

C类：192.168.0.0 - 192.168.255.255

## NAT
网络地址转换NAT：在专用网连接到因特网的路由器上安装nat软件就成了NAT路由器。
他至少有一个有效的外部全球ip。





