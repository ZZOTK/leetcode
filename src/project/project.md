## 分库分表
在这个项目中，对于不同的微服务模块，我们使用了分库分表的设计。在文章，招聘，问答，吐槽等模块，都使用了单独的数据库。

### 为什么要分库分表

分库：一个系统的多张数据表，存储到多个数据库实例中；

分表: 分为水平切分与垂直切分

### 垂直分库垂直分表

垂直分库其实是一种简单逻辑分割。比如我们的数据库中有商品表Products、还有对订单表Orders，还有积分表Scores。接下来我们就可以创建三个数据库，一个数据库存放商品，一个数据库存放订单，一个数据库存放积分。


## 读写分离的情况下如何保持数据一致性
![img_1.png](dxfl.png)

MySQL之间数据复制的基础是二进制日志文件（binary log file）。一台MySQL数据库一旦启用二进制日志后，其作为master，它的数据库中所有操作都会以“事件”的方式记录在二进制日志中，其他数据库作为slave通过一个I/O线程与主服务器保持通信，并监控master的二进制日志文件的变化，如果发现master二进制日志文件发生变化，则会把变化复制到自己的中继日志（Relay log）中，然后slave的一个SQL线程会把相关的“事件”执行到自己的数据库中，以此实现从数据库和主数据库的一致性，也就实现了主从复制。

简言之可分为下面几个步骤：
1. 主库的更新事件会被写到bin log日志中。
2. 从库启用slave服务，发起连接，连接到主库。
3. 从库创建一个I/O线程，从主库读取bin log日志的内容并写入到relay log日志中。
4. 从库创建一个SQL线程，从relay log里面读取内容，将更新内容写入到从库。

