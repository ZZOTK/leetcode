# 索引
MySQL官方对索引的定义为：索引（Index）是帮助MySQL高效获取数据的数据结构。        
提取句子主干，就可以得到索引的本质：索引是数据结构。

## 索引的分类
* 主键索引（PRIMARY KEY）
    * 唯一的标识，主键不可重复，只能有一个
* 唯一索引（UNIQUE KEY）
    * 避免重复的列出现。
    * 唯一索引可以重复，可以多个列设置唯一索引
* 常规索引（KEY INDEX）
    * 默认的index。key关键字设置
* 全文索引（FULLTEXT）
    * 特定数据库才有，MyISAM
    * 快速定位数据
    
## B+Tree
MySQL普遍使用B+Tree实现其索引结构。

红黑树等平衡树也可以用来实现索引，但是文件系统及数据库系统普遍采用 B+ Tree 作为索引结构，这是因为使用 B+ 树访问磁盘数据有更高的性能。

1. 为什么要用树？

hash可以做到查找更快，但是数据库需要更多的是范围查询而不是单条操作。树**有序**，可以提高效率；

## 为什么使用B+树

1. B+ 树有更低的树高
* 因为二叉搜索树保存在硬盘中，我们每访问一个节点，就对应着一次硬盘 IO 操作，上面有说过向硬盘读取数据速度比较慢。因此树的高度就代表硬盘 IO 操作的次数，所以我们要想办法让树的高度变矮，来减少硬盘 IO。
* 平衡树的树高 O(h)=O(logdN)，其中 d 为每个节点的出度。红黑树的出度为 2，而 B+ Tree 的出度一般都非常大，所以红黑树的树高 h 很明显比 B+ Tree 大非常多。
2. B树我们在遍历，分组，排序时需要中序遍历才可以得到，实现繁琐，B+树的链表本身就是连贯有序的。

磁盘访问原理

操作系统一般将内存和磁盘分割成固定大小的块，每一块称为一页，内存与磁盘以页为单位交换数据。数据库系统将索引的一个节点的大小设置为页的大小，使得一次 I/O 就能完全载入一个节点。

如果数据不在同一个磁盘块上，那么通常需要移动制动手臂进行寻道，而制动手臂因为其物理结构导致了移动效率低下，从而增加磁盘数据读取时间。B+ 树相对于红黑树有更低的树高，进行寻道的次数与树高成正比，在同一个磁盘块上进行访问只需要很短的磁盘旋转时间，所以 B+ 树更适合磁盘数据的读取。

（三）磁盘预读特性

* 为了减少磁盘 I/O 操作，磁盘往往不是严格按需读取，而是每次都会预读。预读过程中，磁盘进行顺序读取，顺序读取不需要进行磁盘寻道，并且只需要很短的磁盘旋转时间，速度会非常快。并且可以利用预读特性，相邻的节点也能够被预先载入。

一般来说，索引本身也很大，不可能全部存储在内存中，因此索引往往以索引文件的形式存储的磁盘上。这样的话，索引查找过程中就要产生磁盘I/O消耗，相对于内存存取，I/O存取的消耗要高几个数量级，所以评价一个数据结构作为索引的优劣最重要的指标就是在查找过程中磁盘I/O操作次数的渐进复杂度。

* 换句话说，**索引的结构组织要尽量减少查找过程中磁盘I/O的存取次数。**

## 联合索引、覆盖索引
